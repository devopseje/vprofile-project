
def COLOR_MAP = [
     'SUCCESS': 'good',
     'FAILURE': 'danger'
]
pipeline {
       agent any
       tools {
        maven 'Maven3'
        jdk 'java8'
       }

       environment {
          cluster = "vproprod"
          service = "vproappprodsvc"
            
       }


       stages {
          stage('Deploy to prod ECS'){
               steps {
                    withAWS(credentials: 'awscreds', region: 'eu-west-3'){
                      sh 'aws ecs update-service --cluster ${cluster} --service ${service} --force-new-deployment'   
                    }
               }
          }

          }
          post {
               always {
                    echo 'Slack Notifications'
                    slackSend channel: '#vpro-pro',
                    color: COLOR_MAP[currentBuild.currentResult],
                    message: "*${currentBuild.currentResult}:* Job ${env.JOB_NAME} build ${env.BUILD_NUMBER} \n More info at: ${env.BUILD_URL}"
               }
          }
       }
     
       
